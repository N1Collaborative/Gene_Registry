<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Table Display</title>
    <script>
        async function loadTable() {
            try {
                const response = await fetch("https://gene-registry.onrender.com/api/data");
                const data = await response.json();

                let table = document.getElementById("data-table");

                // Check if data is empty
                if (data.length === 0) {
                    table.innerHTML = "<p>No data found.</p>";
                    return;
                }

                // Create table headers
                let headers = Object.keys(data[0]);
                let headerRow = "<tr>";
                headers.forEach(header => {
                    headerRow += `<th>${header}</th>`;
                });
                headerRow += "</tr>";
                table.innerHTML = headerRow;

                // Populate table rows
                data.forEach((item) => {
                    let row = "<tr>";
                    headers.forEach(header => {
                        row += `<td>${item[header] || 'N/A'}</td>`;
                    });
                    row += "</tr>";
                    table.innerHTML += row;
                });

            } catch (error) {
                console.error("Error loading data:", error);
                document.getElementById("data-table").innerHTML = "<p>Error loading data.</p>";
            }
        }
    </script>
</head>
<body onload="loadTable()">
    <h1>Excel Table Display</h1>
    <table border="1" id="data-table"></table>
</body>
</html>
